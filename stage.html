<!DOCTYPE html>
<html lang="ja">
<head>
Â  <meta charset="UTF-8" />
Â  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
Â  <title>CNP-CATCH</title>
Â  <style>
Â  Â  /* CSSã¯å¤‰æ›´ãªã— */
Â  Â  *{margin:0;padding:0;box-sizing:border-box;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none;-webkit-touch-callout:none;-webkit-tap-highlight-color:transparent}
Â  Â  @import url('https://fonts.googleapis.com/css2?family=Noto+Sans+JP:wght@400;700&display=swap');
Â  Â  body{
Â  Â  Â  width:100vw;height:100vh;overflow:hidden;
Â  Â  Â  font-family:'Noto Sans JP',sans-serif;
Â  Â  Â  touch-action:manipulation;-webkit-overflow-scrolling:touch;
Â  Â  }
Â  Â  #page-wrapper{
Â  Â  Â  width:100%;height:100%;
Â  Â  Â  background:#000;
Â  Â  Â  display:flex;justify-content:center;align-items:center;
Â  Â  Â  position:relative;overflow:hidden;
Â  Â  }
Â  Â  #game-container{
Â  Â  Â  position:relative;width:100%;max-width:380px;height:100%;
Â  Â  Â  background:#000;
Â  Â  Â  overflow:hidden;
Â  Â  Â  transition: box-shadow 0.3s ease-in-out; 
Â  Â  }
Â  Â  .bg-bubble-particle{position:absolute;border-radius:50%;pointer-events:none;animation:float-bubble linear infinite;z-index:1;opacity:0}
Â  Â  .bg-bubble-particle.yellow{background:rgba(255,215,0,.15)}
Â  Â  .bg-bubble-particle.white{background:rgba(255,250,240,.12)}
Â  Â  @keyframes float-bubble{
Â  Â  Â  0%{transform:translateY(105%) scale(var(--bubble-scale));opacity:0}
Â  Â  Â  20%,80%{opacity:var(--bubble-opacity)}
Â  Â  Â  100%{transform:translateY(-10%) scale(var(--bubble-scale));opacity:0}
Â  Â  }
Â  Â  .outer-shell-particle{
Â  Â  Â  position:absolute;pointer-events:none;opacity:0;z-index:5;
Â  Â  Â  background:rgba(245,222,179,.3);
Â  Â  Â  width:var(--shell-width);height:var(--shell-height);
Â  Â  Â  border-radius:30% 70% 20% 80%/50% 40% 60% 50%;
Â  Â  Â  animation:fall-outer-shell linear infinite;
Â  Â  }
Â  Â  @keyframes fall-outer-shell{
Â  Â  Â  0%{transform:translateY(-10vh) translateX(var(--outer-start-x)) rotateZ(0) rotateY(var(--outer-rotate-y-start));opacity:0}
Â  Â  Â  10%,90%{opacity:.5}
Â  Â  Â  100%{transform:translateY(110vh) translateX(var(--outer-end-x)) rotateZ(var(--outer-rotate-z-end)) rotateY(var(--outer-rotate-y-end));opacity:0}
Â  Â  }
Â  Â  @keyframes game-twinkle {
Â  Â  Â  0%, 100% { transform: scale(.3); opacity: 0; }
Â  Â  Â  10%      { opacity: .6; }
Â  Â  Â  50%      { opacity: .8; transform: scale(.5); }
Â  Â  Â  90%      { opacity: .6; }
Â  Â  }
Â  Â  .game-bg-star {
Â  Â  Â  position: absolute;
Â  Â  Â  width: 2px;
Â  Â  Â  height: 2px;
Â  Â  Â  border-radius: 50%;
Â  Â  Â  background: #fff;
Â  Â  Â  pointer-events: none;
Â  Â  Â  animation: game-twinkle 4s linear infinite;
Â  Â  Â  filter: drop-shadow(0 0 2px #fff) drop-shadow(0 0 4px #fff);
Â  Â  Â  z-index: 0;
Â  Â  }
Â  Â  #character{
Â  Â  Â  position:absolute;bottom:80px;left:50%;
Â  Â  Â  transform:translateX(-50%) scale(1);
Â  Â  Â  max-height:20vh;max-width:100px;height:auto;z-index:50;
Â  Â  Â  filter:drop-shadow(2px 4px 8px rgba(0,0,0,.2));
Â  Â  Â  transition: transform 0.2s ease-out, filter 0.2s ease-out;
Â  Â  }
Â  Â  #character.jump{
Â  Â  Â  Â  animation:jump-anim .6s ease;
Â  Â  }
Â  Â  #character.powerup{
Â  Â  Â  filter:drop-shadow(0 0 15px #FFD700) drop-shadow(2px 4px 8px rgba(0,0,0,.2));
Â  Â  Â  transform:translateX(-50%) scale(1.5);
Â  Â  }
Â  Â  #character.fever-character {}
Â  Â  #character.powerup.fever-character {
Â  Â  Â  transform: translateX(-50%) scale(1.65); 
Â  Â  Â  animation: character-fever-powerup-aura 0.25s infinite alternate;
Â  Â  }
Â  Â  @keyframes character-fever-powerup-aura { 
Â  Â  Â  Â  0% { filter: drop-shadow(0 0 15px red) drop-shadow(0 0 20px orange) drop-shadow(0 0 25px yellow) drop-shadow(2px 4px 8px rgba(0,0,0,.2)); }
Â  Â  Â  Â  50% { filter: drop-shadow(0 0 25px yellow) drop-shadow(0 0 30px gold) drop-shadow(0 0 35px orangered) drop-shadow(2px 4px 8px rgba(0,0,0,.2)); }
Â  Â  Â  Â  100% { filter: drop-shadow(0 0 15px orangered) drop-shadow(0 0 20px yellow) drop-shadow(0 0 25px gold) drop-shadow(2px 4px 8px rgba(0,0,0,.2)); }
Â  Â  }
Â  Â  #character.fever-character:not(.powerup) {
Â  Â  Â  Â  animation: character-fever-only-aura 0.3s infinite alternate;
Â  Â  }
Â  Â  @keyframes character-fever-only-aura {
Â  Â  Â  Â  0% { filter: drop-shadow(0 0 15px #ff00ff) drop-shadow(0 0 20px #ff00ff) drop-shadow(2px 4px 8px rgba(0,0,0,.2)); }
Â  Â  Â  Â  100% { filter: drop-shadow(0 0 20px #ff00ff) drop-shadow(0 0 25px #ee82ee) drop-shadow(2px 4px 8px rgba(0,0,0,.2)); }
Â  Â  }
Â  Â  @keyframes jump-anim{ 
Â  Â  Â  0% { transform: translateX(-50%) translateY(0) scale(var(--current-scale, 1)); }
Â  Â  Â  30%, 60% { transform: translateX(-50%) translateY(-60px) scale(var(--current-scale, 1)); }
Â  Â  Â  100% { transform: translateX(-50%) translateY(0) scale(var(--current-scale, 1)); }
Â  Â  }
Â  Â  #character.electrocuted {
Â  Â  Â  animation: electric-shock 0.08s infinite;
Â  Â  }
Â  Â  @keyframes electric-shock {
Â  Â  Â  0% { transform: translateX(-51%) rotate(-2deg) scale(var(--current-scale, 1)); }
Â  Â  Â  25% { transform: translateX(-49%) rotate(2deg) scale(var(--current-scale, 1)); }
Â  Â  Â  50% { transform: translateX(-51%) rotate(-1deg) scale(var(--current-scale, 1)); }
Â  Â  Â  75% { transform: translateX(-49%) rotate(1deg) scale(var(--current-scale, 1)); }
Â  Â  Â  100% { transform: translateX(-50%) rotate(0deg) scale(var(--current-scale, 1)); }
Â  Â  }
Â  Â  .egg,.bomb,.power-up,.time-plus,.helper-mgchan,.helper-ikehaya,.helper-road, .lightning, .makimono {
Â  Â  Â  position:absolute;pointer-events:none;z-index:40;
Â  Â  Â  background-position:center;background-repeat:no-repeat;background-size:contain;
Â  Â  }
Â  Â  .egg{
Â  Â  Â  --start-rot-z: 0deg;
Â  Â  Â  --end-rot-z  : 0deg;
Â  Â  Â  background-color: #fff;
Â  Â  Â  width:30px;
Â  Â  Â  height:30px;
Â  Â  Â  clip-path: polygon(50% 0%, 61% 35%, 98% 35%, 68% 57%, 79% 91%, 50% 70%, 21% 91%, 32% 57%, 2% 35%, 39% 35%);
Â  Â  Â  animation-name:fall-egg;animation-timing-function:linear;
Â  Â  Â  filter:drop-shadow(0 2px 2px rgba(0,0,0,.15));
Â  Â  }
Â  Â  .egg.special{
Â  Â  Â  background-color: #87CEEB;
Â  Â  Â  width:38px;
Â  Â  Â  height:38px;
Â  Â  Â  animation-name:fall-special-egg;animation-timing-function:linear;
Â  Â  Â  filter:drop-shadow(0 2px 4px rgba(0,0,0,.2));
Â  Â  }
Â  Â  .egg.golden{
Â  Â  Â  background-color: #FFD700;
Â  Â  Â  width:46px;
Â  Â  Â  height:46px;
Â  Â  Â  animation-name:fall-golden-egg;animation-timing-function:linear;
Â  Â  Â  filter:drop-shadow(0 0 15px gold) drop-shadow(0 0 5px white);
Â  Â  }
Â  Â  .makimono {
Â  Â  Â  width: 55px;
Â  Â  Â  height: 55px;
Â  Â  Â  background-image: url("makimono.webp"); 
Â  Â  Â  animation-name: fall-powerup; 
Â  Â  Â  filter: drop-shadow(0 0 10px #ffd700) drop-shadow(0 0 15px #ff8c00) drop-shadow(0 0 5px #ffffff);
Â  Â  Â  z-index: 45; 
Â  Â  }
Â  Â  .fever-item-glow {
Â  Â  Â  filter: drop-shadow(0 0 8px #FFD700) drop-shadow(0 0 15px #FFA500) drop-shadow(0 0 5px #ffffff) !important;
Â  Â  Â  transform: scale(1.1); 
Â  Â  }
Â  Â  .helper-mgchan{
Â  Â  Â  width:60px;height:60px;
Â  Â  Â  background-image:url("MG Chan.PNG");
Â  Â  Â  animation-name:fall-helper;animation-timing-function:linear;
Â  Â  Â  border-radius:15px;
Â  Â  Â  filter:drop-shadow(0 3px 5px rgba(0,0,0,.3));
Â  Â  }
Â  Â  .helper-ikehaya, .helper-road {
Â  Â  Â  width:60px;
Â  Â  Â  height:60px;
Â  Â  Â  animation-name:fall-helper;
Â  Â  Â  animation-timing-function:linear;
Â  Â  Â  border-radius:15px;
Â  Â  Â  filter:drop-shadow(0 3px 5px rgba(0,0,0,.3));
Â  Â  }
Â  Â  .helper-ikehaya {
Â  Â  Â  background-image:url("ikehaya.webp");
Â  Â  }
Â  Â  .helper-road {
Â  Â  Â  background-image:url("Road.webp");
Â  Â  }
Â  Â  .bomb{
Â  Â  Â  width:40px;height:40px;
Â  Â  Â  background:radial-gradient(circle,#5a3d32 0%,#3e2723 70%,#2d1b17 100%);
Â  Â  Â  border-radius:50%;
Â  Â  Â  filter:drop-shadow(0 0 10px rgba(40,20,10,.8));
Â  Â  Â  animation-name:fall-bomb;animation-timing-function:linear;
Â  Â  }
Â  Â  .bomb::before{
Â  Â  Â  content:'ğŸ’£';position:absolute;top:50%;left:50%;
Â  Â  Â  transform:translate(-50%,-50%);
Â  Â  Â  font-size:28px;color:#FF4500;text-shadow:0 0 5px #FF0000;
Â  Â  Â  animation:bomb-pulse .5s infinite alternate;
Â  Â  }
Â  Â  .power-up{
Â  Â  Â  width:45px;height:45px;border-radius:50%;
Â  Â  Â  background:linear-gradient(45deg,#FFD700,#FFA500,#FF8C00,#FF7F50,#FF6347);
Â  Â  Â  filter:drop-shadow(0 0 15px rgba(255,165,0,.8));
Â  Â  Â  animation:fall-powerup linear 1,var(--dummy,1s) ease infinite;
Â  Â  }
Â  Â  .power-up::before{
Â  Â  Â  content:'ğŸŒŸ';position:absolute;top:50%;left:50%;
Â  Â  Â  transform:translate(-50%,-50%);font-size:25px;
Â  Â  Â  animation:star-spin 1.5s linear infinite;
Â  Â  }
Â  Â  .time-plus{
Â  Â  Â  width:40px;height:40px;border-radius:50%;
Â  Â  Â  background:radial-gradient(circle,#F0E68C 0%,#EEE8AA 50%,#BDB76B 100%);
Â  Â  Â  filter:drop-shadow(0 0 8px rgba(218,165,32,.7));
Â  Â  Â  animation:fall-time-plus linear;
Â  Â  }
Â  Â  .time-plus::before{
Â  Â  Â  content:'â±ï¸';position:absolute;top:50%;left:50%;
Â  Â  Â  transform:translate(-50%,-50%);font-size:25px;
Â  Â  Â  animation:time-pulse 1.5s ease-in-out infinite alternate;
Â  Â  }
Â  Â  .lightning {
Â  Â  Â  width: 45px;
Â  Â  Â  height: 45px;
Â  Â  Â  font-size: 38px;
Â  Â  Â  display: flex;
Â  Â  Â  justify-content: center;
Â  Â  Â  align-items: center;
Â  Â  Â  color: #FFFF00;
Â  Â  Â  text-shadow: 0 0 5px #FFD700, 0 0 10px #FFEA00;
Â  Â  Â  animation-name: fall-bomb; 
Â  Â  Â  animation-timing-function: linear;
Â  Â  Â  filter: drop-shadow(0 0 8px gold);
Â  Â  }
Â  Â  .lightning::before {
Â  Â  Â  content: 'âš¡ï¸';
Â  Â  }
Â  Â  #scoreboard,#level-display,.control-btn,.power-effect,.combo-display,.level-up-effect{position:fixed;z-index:200}
Â  Â  #scoreboard{top:15px;right:20px;font-size:14px;font-weight:bold;color:#604020;background:linear-gradient(145deg,#fff8dc 0%,#ffefd5 100%);padding:15px 20px;border-radius:20px;line-height:1.6;box-shadow:0 8px 24px rgba(0,0,0,.1),0 4px 8px rgba(139,69,19,.2);border:2px solid rgba(210,180,140,.5);backdrop-filter:blur(10px);min-width:180px;}
Â  Â  #level-display{top:15px;left:20px;font-size:16px;font-weight:bold;color:#604020;background:linear-gradient(145deg,#fff8dc 0%,#ffefd5 100%);padding:12px 18px;border-radius:15px;box-shadow:0 4px 12px rgba(0,0,0,.1),0 2px 4px rgba(139,69,19,.2);border:2px solid rgba(210,180,140,.5);backdrop-filter:blur(5px);}
Â  Â  .combo-display{top:50%;left:50%;transform:translate(-50%,-50%);font-size:24px;font-weight:bold;color:#FF8C00;background:rgba(60,30,10,.85);padding:10px 20px;border-radius:15px;display:none;animation:combo-pop 1s ease-out;text-shadow:1px 1px 2px rgba(255,255,255,.3);z-index:210;}
Â  Â  #gameover{position:absolute;top:50%;left:50%;transform:translate(-50%,-50%);font-size:28px;font-weight:bold;background:linear-gradient(145deg,rgba(80,50,20,.9),rgba(50,30,10,.85));color:#fff8dc;padding:30px;border-radius:20px;display:none;z-index:150;text-align:center;box-shadow:0 10px 30px rgba(0,0,0,.5);border:2px solid rgba(210,180,140,.3);width:90%;max-width:380px;}
Â  Â  #return-to-select-btn{background:#D2691E;color:#fff;border:none;padding:12px 25px;margin-top:25px;font-size:16px;border-radius:8px;cursor:pointer;transition:.3s;}
Â  Â  #return-to-select-btn:hover{background:#A0522D}
Â  Â  .control-btn{bottom:15px;width:55px;height:55px;font-size:22px;border-radius:50%;border:none;background:linear-gradient(145deg,rgba(210,180,140,.9) 0%,rgba(139,69,19,.8) 100%);color:#fff;cursor:pointer;box-shadow:0 6px 18px rgba(139,69,19,.4),0 3px 6px rgba(0,0,0,.2);border:2px solid rgba(255,255,255,.4);transition:.2s;}
Â  Â  .control-btn:active{transform:scale(.95);box-shadow:0 3px 9px rgba(139,69,19,.4),0 1px 3px rgba(0,0,0,.2)}
Â  Â  .power-effect{bottom:150px;left:20px;padding:8px 16px;font-size:14px;font-weight:bold;background:linear-gradient(45deg,#FFA500,#FF4500);color:#fff;border-radius:20px;display:none;animation:power-glow .5s ease-in-out infinite alternate;}
Â  Â  .level-up-effect{top:30%;left:50%;transform:translate(-50%,-50%);font-size:32px;font-weight:bold;color:#CD853F;background:linear-gradient(45deg,rgba(255,228,181,.9),rgba(255,218,185,.8));padding:20px 40px;border-radius:20px;display:none;animation:level-up-animation 2s ease-out;text-shadow:1px 1px 2px rgba(100,50,0,.5);border:3px solid rgba(255,255,255,.8);z-index:210;}
Â  Â  #game-container.fever-active {
Â  Â  Â  animation: fever-glow-animation 0.4s infinite alternate;
Â  Â  }
Â  Â  @keyframes fever-glow-animation {
Â  Â  Â  from { box-shadow: 0 0 25px #FFD700, 0 0 35px #FF8C00 inset, 0 0 30px #FFFACD; }
Â  Â  Â  to   { box-shadow: 0 0 40px #FFA500, 0 0 50px #FF4500 inset, 0 0 45px #FFD700; }
Â  Â  }
Â  Â  #fever-mode-display {
Â  Â  Â  position: fixed; 
Â  Â  Â  top: 35%; left: 50%;
Â  Â  Â  transform: translate(-50%, -50%);
Â  Â  Â  font-size: 38px; font-weight: bold;
Â  Â  Â  color: #fff;
Â  Â  Â  background: linear-gradient(45deg, #ff1493, #ff69b4, #ff7f50, #ffa500, #ffd700);
Â  Â  Â  -webkit-background-clip: text; background-clip: text; color: transparent;
Â  Â  Â  padding: 15px 30px; border-radius: 20px;
Â  Â  Â  text-shadow: 0 0 5px rgba(255,255,255,0.8), 0 0 10px #ff8c00, 0 0 15px #ff4500;
Â  Â  Â  border: 3px solid;
Â  Â  Â  border-image-slice: 1;
Â  Â  Â  border-image-source: linear-gradient(to right, gold, orangered);
Â  Â  Â  box-shadow: 0 0 20px rgba(255,100,0,0.7);
Â  Â  Â  display: none; 
Â  Â  Â  z-index: 220;
Â  Â  Â  animation: fever-text-pop-anim 2.5s ease-out forwards;
Â  Â  }
Â  Â  @keyframes fever-text-pop-anim {
Â  Â  Â  0% { transform: translate(-50%, -50%) scale(0.3) rotate(-15deg); opacity: 0; }
Â  Â  Â  20% { transform: translate(-50%, -50%) scale(1.2) rotate(5deg); opacity: 1; }
Â  Â  Â  80% { transform: translate(-50%, -50%) scale(1.1) rotate(0deg); opacity: 1; }
Â  Â  Â  100% { transform: translate(-50%, -50%) scale(1.1) rotate(0deg); opacity: 0; }
Â  Â  }
Â  Â  #game-container.fever-active .game-bg-star {
Â  Â  Â  Â  animation-duration: 0.8s !important; 
Â  Â  Â  Â  filter: drop-shadow(0 0 4px #FFD700) drop-shadow(0 0 8px #FFD700) drop-shadow(0 0 2px #FFFFFF);
Â  Â  Â  Â  background: #FFFACD; 
Â  Â  Â  Â  transform: scale(var(--fever-star-scale, 0.7)); 
Â  Â  }
Â  Â  @keyframes bomb-pulse{0%{transform:translate(-50%,-50%) scale(1)}100%{transform:translate(-50%,-50%) scale(1.2)}}
Â  Â  @keyframes star-spin{0%{transform:translate(-50%,-50%) rotate(0) scale(1)}50%{transform:translate(-50%,-50%) rotate(180deg) scale(1.2)}100%{transform:translate(-50%,-50%) rotate(360deg) scale(1)}}
Â  Â  @keyframes rainbow-rotate-warm{0%{filter:drop-shadow(0 0 15px rgba(255,165,0,.8)) hue-rotate(0)}100%{filter:drop-shadow(0 0 15px rgba(255,165,0,.8)) hue-rotate(45deg)}}
Â  Â  @keyframes power-glow{0%{box-shadow:0 0 10px rgba(255,165,0,.8)}100%{box-shadow:0 0 20px rgba(255,120,0,1)}}
Â  Â  @keyframes level-up-animation{0%{transform:translate(-50%,-50%) scale(.5) rotate(-10deg);opacity:0}30%{transform:translate(-50%,-50%) scale(1.2) rotate(5deg);opacity:1}70%{transform:translate(-50%,-50%) scale(1.1) rotate(-2deg);opacity:1}100%{transform:translate(-50%,-50%) scale(1) rotate(0);opacity:0}}
Â  Â  @keyframes time-pulse{0%{transform:translate(-50%,-50%) scale(1) rotate(0);opacity:.8}50%{transform:translate(-50%,-50%) scale(1.15) rotate(5deg);opacity:1}100%{transform:translate(-50%,-50%) scale(1) rotate(0);opacity:.8}}
Â  Â  @keyframes fall-egg{0%{transform:translateY(-70px) rotateZ(var(--start-rot-z)) scale(.8);opacity:.6}100%{transform:translateY(105vh) rotateZ(var(--end-rot-z));opacity:1}}
Â  Â  @keyframes fall-special-egg{0%{transform:translateY(-60px) rotateZ(0) scale(.9);opacity:.8}50%{transform:translateY(50vh) rotateZ(90deg) scale(1.1)}100%{transform:translateY(105vh) rotateZ(180deg) scale(.9);opacity:1}}
Â  Â  @keyframes fall-golden-egg{0%{transform:translateY(-60px) rotateZ(0) scale(1);opacity:.9}25%{transform:translateY(25vh) rotateZ(var(--random-rotate-half)) scale(1.15)}100%{transform:translateY(105vh) rotateZ(var(--random-rotate)) scale(1);opacity:1}}
Â  Â  @keyframes fall-helper{0%{transform:translateY(-80px) scale(.7) rotate(-15deg);opacity:.7}50%{transform:translateY(40vh) scale(1) rotate(15deg);opacity:1}100%{transform:translateY(105vh) scale(.8) rotate(5deg);opacity:.9}}
Â  Â  @keyframes fall-bomb{0%{transform:translateY(-50px) rotate(0) scale(1);opacity:1}30%{transform:translateY(30vh) rotate(-20deg) scale(1.05)}60%{transform:translateY(60vh) rotate(15deg) scale(1.1)}100%{transform:translateY(100vh) rotate(10deg) scale(1);opacity:1}}
Â  Â  @keyframes fall-powerup{0%{transform:translateY(-50px) scale(.8);opacity:.8}25%{transform:translateY(25vh) scale(1.1);opacity:1}50%{transform:translateY(50vh) scale(1.2)}75%{transform:translateY(75vh) scale(1.1)}100%{transform:translateY(100vh) scale(1);opacity:1}}
Â  Â  @keyframes fall-time-plus{0%{transform:translateY(-50px) translateX(0) rotate(0) scale(.9);opacity:.7}25%{transform:translateY(25vh) translateX(10px) rotate(5deg) scale(1);opacity:1}50%{transform:translateY(50vh) translateX(-10px) rotate(-5deg) scale(1.1)}75%{transform:translateY(75vh) translateX(5px) rotate(2deg) scale(1)}100%{transform:translateY(100vh) translateX(0) rotate(0) scale(.9);opacity:1}}
Â  </style>
</head>
<body>
Â  <div id="page-wrapper">
Â  Â  <div id="game-container">
Â  Â  Â  <img id="character" src="" alt="ã‚­ãƒ£ãƒ©ã‚¯ã‚¿ãƒ¼">
Â  Â  Â  <div id="gameover">
Â  Â  Â  Â  <div>ã‚²ãƒ¼ãƒ çµ‚äº†ï¼</div>
Â  Â  Â  Â  <div style="font-size:18px;margin-top:10px">
Â  Â  Â  Â  Â  æœ€çµ‚ã‚¹ã‚³ã‚¢:<span id="final-score">0</span><br>
Â  Â  Â  Â  Â  åˆ°é”ãƒ¬ãƒ™ãƒ«:<span id="final-level">1</span>
Â  Â  Â  Â  </div>
Â  Â  Â  Â  <button id="return-to-select-btn">ã‚­ãƒ£ãƒ©ã‚¯ã‚¿ãƒ¼é¸æŠã«æˆ»ã‚‹</button>
Â  Â  Â  </div>
Â  Â  Â  <div class="combo-display" id="combo-display-popup"></div>
Â  Â  Â  <div class="level-up-effect" id="level-up-effect"></div>
Â  Â  Â  <div class="power-effect"  id="power-effect"></div>
Â  Â  Â  <div id="fever-mode-display">FEVER TIME!</div>
Â  Â  </div>
Â  </div>
Â  <div id="scoreboard">ã‚¹ã‚³ã‚¢:<span id="score">0</span><br>ãƒã‚¤ã‚¹ã‚³ã‚¢:<span id="highscore">0</span><br>æ®‹ã‚Š:<span id="timer">60</span>ç§’<br>ã‚³ãƒ³ãƒœ:<span id="combo">0</span></div>
Â  <div id="level-display">ãƒ¬ãƒ™ãƒ«:<span id="level">1</span></div>
Â  <script>
Â  Â  document.addEventListener('contextmenu',e=>{e.preventDefault()},{passive:false});
Â  Â  document.addEventListener('selectstart',e=>{e.preventDefault()},{passive:false});
Â  Â  document.addEventListener('dragstart',e=>{e.preventDefault()},{passive:false});

Â  Â  const pageWrapper          = document.getElementById("page-wrapper");
Â  Â  const gameContainer        = document.getElementById("game-container");
Â  Â  const character            = document.getElementById("character");
Â  Â  const scoreDisplay         = document.getElementById("score");
Â  Â  const highscoreDisplay     = document.getElementById("highscore");
Â  Â  const timerDisplay         = document.getElementById("timer");
Â  Â  const levelDisplay         = document.getElementById("level");
Â  Â  const comboCountDisplay    = document.getElementById("combo");
Â  Â  const comboPopup           = document.getElementById("combo-display-popup");
Â  Â  const powerEffect          = document.getElementById("power-effect");
Â  Â  const levelUpEffect        = document.getElementById("level-up-effect");
Â  Â  const gameover             = document.getElementById("gameover");
Â  Â  const finalScore           = document.getElementById("final-score");
Â  Â  const finalLevel           = document.getElementById("final-level");
Â  Â  const returnToSelectBtn    = document.getElementById("return-to-select-btn");
Â  Â  const feverModeDisplay     = document.getElementById("fever-mode-display"); 

Â  Â  const selectedImageFile = localStorage.getItem("selectedImage");
Â  Â  const selectedCharName  = localStorage.getItem("selectedName");
Â  Â  if(selectedImageFile && selectedCharName){
Â  Â  Â  character.src = selectedImageFile;
Â  Â  Â  character.alt = selectedCharName;
Â  Â  }else{
Â  Â  Â  character.src = "Leeleeg.webp"; 
Â  Â  Â  character.alt = "Leelee";    
Â  Â  }

Â  Â  let score=0,highscore=0,timeLeft=60;
    // â˜…ãƒ¬ãƒ™ãƒ«å¤‰æ›´: MAX_LEVELã‚’15ã«å¤‰æ›´
Â  Â  const MAX_TIME_LEFT=90,MAX_LEVEL=15; 
Â  Â  let level=1,combo=0,maxCombo=0;
    // â˜…ãƒ¬ãƒ™ãƒ«å¤‰æ›´: levelThresholdsã‚’ãƒ¬ãƒ™ãƒ«15ã¾ã§æ‹¡å¼µ (ãƒ¬ãƒ™ãƒ«5ä»¥é™ã¯+100ãšã¤)
Â  Â  const levelThresholds=[
        0,   30,  80, 150,  250, // Level 1-5 (æ—¢å­˜)
      350, 450, 550, 650,  750, // Level 6-10 (+100ãšã¤)
      850, 950,1050,1150, 1250  // Level 11-15 (+100ãšã¤)
    ]; 
Â  Â  let itemSpawnerId,gameBgParticleInterval,outerEffectInterval, gameTimerId;
Â  Â  let isPowerUpActive=false,powerUpEndTime=0;
Â  Â  let characterX,powerUpTimerId=null;
Â  Â  let lastHelperIndex = -1;
Â  Â  let isCharacterStunned = false; 
Â  Â  let stunTimeoutId = null;       

Â  Â  let isFeverModeActive = false;
Â  Â  let feverModeEndTime = 0;
Â  Â  let feverModeTimerId = null;
Â  Â  let originalBGMVolume = 0.4; 
Â  Â  let feverBGM;
Â  Â  let seFeverStart; 
Â  Â  let feverSpawnedLevel2 = false;
    // â˜…ãƒ•ã‚£ãƒ¼ãƒãƒ¼æ¡ä»¶å¤‰æ›´: feverSpawnedLevel5 ã‚’å‰Šé™¤ã—ã€feverSpawnedByCombo60 ã‚’è¿½åŠ 
Â  Â  let feverSpawnedByCombo60 = false; 
Â  Â  const FEVER_DURATION = 6000; 
Â  Â  let characterSpeedMultiplier = 1; 

Â  Â  let seEggCollect,bgm,seTimePlus,seBomb,sePowerUp,seHelperMG, seHelperIkehaya, seHelperRoad, seLightning, seMakimonoGet;
Â  Â  try{
Â  Â  Â  seEggCollect=new Audio("kirarin.mp3");
Â  Â  Â  bgm           =new Audio("main2.mp3");
Â  Â  Â  seTimePlus  =new Audio("tm.mp3");
Â  Â  Â  seBomb      =new Audio("bom.mp3");
Â  Â  Â  sePowerUp   =new Audio("st.mp3");
Â  Â  Â  seHelperMG  =new Audio("mg_chan_effect.mp3"); 
Â  Â  Â  seHelperIkehaya = new Audio("mg_chan_effect.mp3"); 
Â  Â  Â  seHelperRoad    = new Audio("mg_chan_effect.mp3"); 
Â  Â  Â  seLightning     = new Audio("lightning_strike.mp3");
Â  Â  Â  feverBGM = new Audio("fever_bgm.mp3"); 
Â  Â  Â  seFeverStart = new Audio("powerupGet.mp3"); 
Â  Â  Â  seMakimonoGet = new Audio("powerupGet.mp3"); 

Â  Â  Â  bgm.loop=true;bgm.volume=.3;
Â  Â  Â  feverBGM.loop = true; feverBGM.volume = 0.35; 
Â  Â  }catch(e){
Â  Â  Â  console.error("Audio init error:",e);
Â  Â  Â  const dummy={play:()=>{return Promise.resolve();},currentTime:0, pause:()=>{}}; 
Â  Â  Â  seEggCollect=seTimePlus=seBomb=sePowerUp=seHelperMG=seHelperIkehaya=seHelperRoad=seLightning=seMakimonoGet=dummy;
Â  Â  Â  bgm={play:()=>Promise.resolve(),pause:()=>{},loop:true,volume:.3};
Â  Â  Â  feverBGM = {play:()=>Promise.resolve(),pause:()=>{},loop:true,volume:0.35};
Â  Â  Â  seFeverStart = {play:()=>{return Promise.resolve();}};
Â  Â  }
Â  Â  try{highscore=parseInt(localStorage.getItem("rebornCatchHighscore"))||0}catch(e){}
Â  Â  highscoreDisplay.textContent=highscore;

Â  Â  function createBgBubbleParticle(){ /* å®Ÿè£…æ¸ˆã¿ */ }
Â  Â  function createOuterShellParticle(){ /* å®Ÿè£…æ¸ˆã¿ */ }
Â  Â  function createInGameTwinkleStars(count = 50) {
Â  Â  Â  if (!gameContainer) return;
Â  Â  Â  const existingStars = gameContainer.querySelectorAll('.game-bg-star');
Â  Â  Â  existingStars.forEach(star => star.remove());
Â  Â  Â  for (let i = 0; i < count; i++) {
Â  Â  Â  Â  const starEl = document.createElement('div');
Â  Â  Â  Â  starEl.className = 'game-bg-star';
Â  Â  Â  Â  starEl.style.top = Math.random() * gameContainer.offsetHeight + 'px';
Â  Â  Â  Â  starEl.style.left = Math.random() * gameContainer.offsetWidth + 'px';
Â  Â  Â  Â  const size = 1 + Math.random() * (isFeverModeActive ? 2.5 : 2); 
Â  Â  Â  Â  starEl.style.width = starEl.style.height = size + 'px';
Â  Â  Â  Â  starEl.style.animationDelay = Math.random() * 4 + 's';
Â  Â  Â  Â  starEl.style.animationDuration = (isFeverModeActive ? 1.5 + Math.random() * 1.5 : 3 + Math.random() * 3) + 's';
Â  Â  Â  Â  if (isFeverModeActive) { 
Â  Â  Â  Â  Â  Â  starEl.style.setProperty('--fever-star-scale', (0.6 + Math.random() * 0.5).toFixed(2));
Â  Â  Â  Â  }
Â  Â  Â  Â  gameContainer.appendChild(starEl);
Â  Â  Â  }
Â  Â  }

    // calcLevel ã¯å¤‰æ›´ãªã—ã§OK (levelThresholds ã¨ MAX_LEVEL ã®æ›´æ–°ã§å¯¾å¿œ)
Â  Â  const calcLevel=()=>Math.min(levelThresholds.filter(t=>score>=t).length,MAX_LEVEL);
Â  Â  const spawnRate =()=>Math.max(150, (isFeverModeActive ? 400 : 700) - level * 40 ); 

Â  Â  function updateScore(pt=1,type){
Â  Â  Â  if (isFeverModeActive) {
Â  Â  Â  Â  Â  pt = Math.ceil(pt * 2.5); 
Â  Â  Â  } else if(isPowerUpActive) {
Â  Â  Â  Â  pt*=2;
Â  Â  Â  }
Â  Â  Â  score+=pt;
Â  Â  Â  combo++;
Â  Â  Â  scoreDisplay.textContent=score;
Â  Â  Â  comboCountDisplay.textContent=combo;
Â  Â  Â  const prev=level;level=calcLevel();levelDisplay.textContent=level;
      // â˜…ãƒ¬ãƒ™ãƒ«å¤‰æ›´: MAX_LEVELã«åˆ°é”ã—ãŸéš›ã®ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã‚‚é©åˆ‡ã«è¡¨ç¤ºã•ã‚Œã‚‹
Â  Â  Â  if(level>prev)showLevelUp(level===MAX_LEVEL?`MAX LEVEL ${MAX_LEVEL} åˆ°é”!`:`LEVEL ${level}!`);
Â  Â  Â  if(combo>1)showComboPopup();
Â  Â  Â  if(pt>=5 && (type==="egg golden" || type === "feverBombPoints"))showSpecialEffect();
Â  Â  Â  if(combo>maxCombo)maxCombo=combo;
Â  Â  Â  checkAndSpawnFeverItem(); 
Â  Â  }
Â  Â  const resetCombo=()=>{
Â  Â  Â  Â  if (!isFeverModeActive) {
Â  Â  Â  Â  Â  Â  combo=0;
Â  Â  Â  Â  Â  Â  comboCountDisplay.textContent=combo;
Â  Â  Â  Â  }
Â  Â  };
Â  Â  const showComboPopup=()=>{comboPopup.textContent=`${combo} COMBO!`;comboPopup.style.display='block';setTimeout(()=>comboPopup.style.display='none',1000)};
Â  Â  const showLevelUp=msg=>{levelUpEffect.textContent=msg;levelUpEffect.style.display='block';setTimeout(()=>levelUpEffect.style.display='none',2000)};
Â  Â  const showSpecialEffect=()=>{scoreDisplay.style.cssText="transform:scale(1.3);color:#D4AF37";setTimeout(()=>scoreDisplay.style.cssText="",500)};

Â  Â  function getCurrentCharacterScale() {
Â  Â  Â  Â  if (character.classList.contains("powerup") && isFeverModeActive) return 1.65;
Â  Â  Â  Â  if (character.classList.contains("powerup")) return 1.5;
Â  Â  Â  Â  return 1;
Â  Â  }

Â  Â  function activatePowerUp(){
Â  Â  Â  if(isPowerUpActive){
Â  Â  Â  Â  powerUpEndTime+=10000; 
Â  Â  Â  Â  clearInterval(powerUpTimerId); 
Â  Â  Â  } else {
Â  Â  Â  Â  isPowerUpActive=true;
Â  Â  Â  Â  powerUpEndTime=Date.now()+10000;
Â  Â  Â  Â  character.classList.add("powerup");
Â  Â  Â  Â  if (isFeverModeActive) character.classList.add("fever-character");
Â  Â  Â  Â  powerEffect.style.display='block';
Â  Â  Â  }
Â  Â  Â  powerUpTimerId=setInterval(()=>{
Â  Â  Â  Â  const remain=Math.ceil((powerUpEndTime-Date.now())/1000);
Â  Â  Â  Â  if(remain<=0){deactivatePowerUp();clearInterval(powerUpTimerId)}
Â  Â  Â  Â  else powerEffect.textContent=`ğŸ¥šã‚¹ã‚³ã‚¢ï¼’å€ï¼(${remain}s)`;
Â  Â  Â  },100);
Â  Â  }

Â  Â  function deactivatePowerUp(){
Â  Â  Â  isPowerUpActive=false;
Â  Â  Â  character.classList.remove("powerup"); 
Â  Â  Â  powerEffect.style.display='none';
Â  Â  Â  clearInterval(powerUpTimerId);
Â  Â  Â   if (!character.classList.contains("electrocuted")) {
Â  Â  Â  Â  Â character.style.transform = ''; 
Â  Â  Â  }
Â  Â  }

Â  Â  function spawnMakimonoItem() {
Â  Â  Â  Â  if (timeLeft <= 0) return;
Â  Â  Â  Â  const item = document.createElement("div");
Â  Â  Â  Â  item.className = "makimono"; 
Â  Â  Â  Â  item.dataset.type = "makimono"; 
Â  Â  Â  Â  const w = 55; 
Â  Â  Â  Â  const dur = Math.max(2.5, 3.5 + Math.random() * 1.5 - level * 0.1); 
Â  Â  Â  Â  item.style.left = Math.random() * (gameContainer.offsetWidth - w) + "px";
Â  Â  Â  Â  item.style.animationDuration = dur + "s";
Â  Â  Â  Â  item.style.animationName = "fall-powerup"; 
Â  Â  Â  Â  gameContainer.appendChild(item);
Â  Â  Â  Â  const hit = setInterval(() => {
Â  Â  Â  Â  Â  Â  if (!item.parentNode || timeLeft <= 0) {
Â  Â  Â  Â  Â  Â  Â  Â  clearInterval(hit);
Â  Â  Â  Â  Â  Â  Â  Â  if (item.parentNode) item.remove();
Â  Â  Â  Â  Â  Â  Â  Â  return;
Â  Â  Â  Â  Â  Â  }
Â  Â  Â  Â  Â  Â  const a = item.getBoundingClientRect();
Â  Â  Â  Â  Â  Â  const b = character.getBoundingClientRect();
Â  Â  Â  Â  Â  Â  if (a.top < b.bottom && a.bottom > b.top && a.left < b.right && a.right > b.left) {
Â  Â  Â  Â  Â  Â  Â  Â  handleItemCollection(item); 
Â  Â  Â  Â  Â  Â  Â  Â  item.remove(); 
Â  Â  Â  Â  Â  Â  Â  Â  clearInterval(hit);
Â  Â  Â  Â  Â  Â  }
Â  Â  Â  Â  }, 30);
Â  Â  Â  Â  setTimeout(() => {
Â  Â  Â  Â  Â  Â  if (item.parentNode) item.remove();
Â  Â  Â  Â  Â  Â  clearInterval(hit);
Â  Â  Â  Â  }, dur * 1000 + 300);
Â  Â  }
Â  Â  
Â  Â  function handleItemCollection(itemElement) {
Â  Â  Â  Â  const pts = parseInt(itemElement.dataset.points) || 0;
Â  Â  Â  Â  const itemType = itemElement.dataset.type;
Â  Â  Â  Â  switch (itemType) {
Â  Â  Â  Â  Â  Â  case "bomb":
Â  Â  Â  Â  Â  Â  Â  Â  if (isFeverModeActive) { 
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  updateScore(15, "feverBombPoints"); 
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  seEggCollect?.play().catch(e => console.error("Audio play error:", e));
Â  Â  Â  Â  Â  Â  Â  Â  } else {
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  score = Math.max(0, score + pts);
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  scoreDisplay.textContent = score;
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  resetCombo();
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  seBomb?.play().catch(e => console.error("Audio play error:", e));
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  gameContainer.style.backgroundColor = "rgba(150,50,50,.7)"; 
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  setTimeout(() => { gameContainer.style.backgroundColor = isFeverModeActive ? "" : "#000";}, 150); 
Â  Â  Â  Â  Â  Â  Â  Â  }
Â  Â  Â  Â  Â  Â  Â  Â  break;
Â  Â  Â  Â  Â  Â  case "timePlus":
Â  Â  Â  Â  Â  Â  Â  Â  timeLeft = Math.min(timeLeft + 5, MAX_TIME_LEFT);
Â  Â  Â  Â  Â  Â  Â  Â  timerDisplay.textContent = timeLeft;
Â  Â  Â  Â  Â  Â  Â  Â  seTimePlus?.play().catch(e => console.error("Audio play error:", e));
Â  Â  Â  Â  Â  Â  Â  Â  break;
Â  Â  Â  Â  Â  Â  case "powerup":
Â  Â  Â  Â  Â  Â  Â  Â  sePowerUp?.play().catch(e => console.error("Audio play error:", e));
Â  Â  Â  Â  Â  Â  Â  Â  activatePowerUp();
Â  Â  Â  Â  Â  Â  Â  Â  break;
Â  Â  Â  Â  Â  Â  case "helperIkehaya":
Â  Â  Â  Â  Â  Â  case "helperRoad":
Â  Â  Â  Â  Â  Â  Â  Â  updateScore(pts, itemType);
Â  Â  Â  Â  Â  Â  Â  Â  seHelperMG?.play().catch(e => console.error("Audio play error:", e));
Â  Â  Â  Â  Â  Â  Â  Â  if (!isFeverModeActive) {
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  [...gameContainer.querySelectorAll(".bomb")].slice(0, 2).forEach(b => b.remove());
Â  Â  Â  Â  Â  Â  Â  Â  }
Â  Â  Â  Â  Â  Â  Â  Â  break;
Â  Â  Â  Â  Â  Â  case "lightning":
Â  Â  Â  Â  Â  Â  Â  Â  seLightning?.play().catch(e => console.error("Audio play error:", e));
Â  Â  Â  Â  Â  Â  Â  Â  if (!isCharacterStunned && !isFeverModeActive) { 
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  isCharacterStunned = true;
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  character.style.setProperty('--current-scale', getCurrentCharacterScale());
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  character.classList.add("electrocuted");
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  if (stunTimeoutId) clearTimeout(stunTimeoutId);
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  stunTimeoutId = setTimeout(() => {
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  isCharacterStunned = false;
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  character.classList.remove("electrocuted");
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  character.style.removeProperty('--current-scale');
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â   character.style.transform = ''; 
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  }, 3000);
Â  Â  Â  Â  Â  Â  Â  Â  } else if (isFeverModeActive) { 
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  updateScore(20, "feverLightningBonus");
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  seEggCollect?.play().catch(e => console.error("Audio play error:", e));
Â  Â  Â  Â  Â  Â  Â  Â  }
Â  Â  Â  Â  Â  Â  Â  Â  break;
Â  Â  Â  Â  Â  Â  case "makimono": 
Â  Â  Â  Â  Â  Â  Â  Â  if (!isFeverModeActive) { 
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  seMakimonoGet?.play().catch(e => console.error("Audio play error:", e));
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  activateFeverMode();
Â  Â  Â  Â  Â  Â  Â  Â  }
Â  Â  Â  Â  Â  Â  Â  Â  break;
Â  Â  Â  Â  Â  Â  case "feverBombPoints": 
Â  Â  Â  Â  Â  Â  Â  Â  Â updateScore(pts, itemType); 
Â  Â  Â  Â  Â  Â  Â  Â  Â seEggCollect?.play().catch(e => console.error("Audio play error:", e));
Â  Â  Â  Â  Â  Â  Â  Â  Â break;
Â  Â  Â  Â  Â  Â  default: 
Â  Â  Â  Â  Â  Â  Â  Â  updateScore(pts, itemType);
Â  Â  Â  Â  Â  Â  Â  Â  seEggCollect?.play().catch(e => console.error("Audio play error:", e));
Â  Â  Â  Â  }
Â  Â  }

Â  Â  function createItem () {
Â  Â  Â  if (timeLeft <= 0) return;
Â  Â  Â  const r = Math.random();
Â  Â  Â  let bombProb = (level >= 2) ? Math.min(.05 + (level - 2) * .03, .14) : 0;
Â  Â  Â  if (isFeverModeActive) {
Â  Â  Â  Â  Â  bombProb = 0;
Â  Â  Â  }
Â  Â  Â  const prob = { bomb: bombProb, timePlus: .08, powerUp: .0, helper: .06, gold: .10, special: .15, lightning: .05 };
Â  Â  Â  if (level >= 2) {
Â  Â  Â  Â  prob.powerUp = .07;
Â  Â  Â  Â  prob.lightning = (isFeverModeActive? 0.02 : Math.min(.05 + (level - 2) * .01, .08)); 
Â  Â  Â  }
Â  Â  Â  let sum  = 0;
Â  Â  Â  let type = "normalEgg";
Â  Â  Â  const pick = (p, t) => { sum += p; if(r < sum && type === "normalEgg") type = t; return r < sum; };
Â  Â  Â  pick(prob.bomb,   "bomb"      ) ||
Â  Â  Â  pick(prob.timePlus,"timePlus") ||
Â  Â  Â  pick(prob.powerUp,"powerup"   ) ||
Â  Â  Â  pick(prob.helper, "helper"    ) ||
Â  Â  Â  pick(prob.lightning, "lightning") ||
Â  Â  Â  pick(prob.gold,   "egg golden") ||
Â  Â  Â  pick(prob.special,"egg special");

Â  Â  Â  const item = document.createElement("div");
Â  Â  Â  let w;
Â  Â  Â  let currentHelperType = "";
Â  Â  Â  if (type === "helper") {
Â  Â  Â  Â  const helpers = ["helperIkehaya", "helperRoad"];
Â  Â  Â  Â  lastHelperIndex = (lastHelperIndex + 1) % helpers.length;
Â  Â  Â  Â  currentHelperType = helpers[lastHelperIndex];
Â  Â  Â  Â  type = currentHelperType;
Â  Â  Â  }
Â  Â  Â  if (isFeverModeActive) {
Â  Â  Â  Â  Â  if (type === "normalEgg") { type = "egg special"; } 
Â  Â  Â  Â  Â  else if (type === "egg special") { type = "egg golden"; } 
Â  Â  Â  }
Â  Â  Â  switch (type) {
Â  Â  Â  Â  case "bomb"         : item.className = "bomb";            item.dataset.points = "-10"; w = 40; break;
Â  Â  Â  Â  case "timePlus"     : item.className = "time-plus";      item.dataset.points = "0";   w = 40; break;
Â  Â  Â  Â  case "powerup"      : item.className = "power-up";       item.dataset.points = "0";   w = 45; break;
Â  Â  Â  Â  case "helperIkehaya": item.className = "helper-ikehaya"; item.dataset.points = "25";  w = 60; break;
Â  Â  Â  Â  case "helperRoad"   : item.className = "helper-road";    item.dataset.points = "25";  w = 60; break;
Â  Â  Â  Â  case "lightning"    : item.className = "lightning";      item.dataset.points = "0";   w = 45; break;
Â  Â  Â  Â  case "egg golden"   : item.className = "egg golden";     item.dataset.points = "5";   w = 46; break;
Â  Â  Â  Â  case "egg special"  : item.className = "egg special";    item.dataset.points = "2";   w = 38; break;
Â  Â  Â  Â  default             : item.className = "egg";            item.dataset.points = "1";   w = 30; type = "normalEgg"; 
Â  Â  Â  }
Â  Â  Â  item.dataset.type = type; 
Â  Â  Â  if (isFeverModeActive && type !== "makimono") { 
Â  Â  Â  Â  Â  item.classList.add("fever-item-glow");
Â  Â  Â  }
Â  Â  Â  const dur = Math.max(1.5, 2.5 + Math.random() * 2 - level * 0.15);
Â  Â  Â  item.style.left            = Math.random() * (gameContainer.offsetWidth - w) + "px";
Â  Â  Â  item.style.animationDuration = dur + "s";
Â  Â  Â  item.style.animationName =
Â  Â  Â  Â  Â  Â  type === "egg special" ? "fall-special-egg" :
Â  Â  Â  Â  Â  Â  type === "egg golden"  ? "fall-golden-egg"  :
Â  Â  Â  Â  Â  Â  type.startsWith("helper") ? "fall-helper" :
Â  Â  Â  Â  Â  Â  type === "lightning" ? "fall-bomb" : 
Â  Â  Â  Â  Â  Â  "fall-egg";
Â  Â  Â  item.style.setProperty("--start-rot-z",  ((Math.random() - .5) * 60).toFixed(1) + "deg");
Â  Â  Â  item.style.setProperty("--end-rot-z",    ((Math.random() - .5) * 90).toFixed(1) + "deg");
Â  Â  Â  item.style.setProperty("--random-rotate",      ((Math.random() - .5) * 70).toFixed(1) + "deg");
Â  Â  Â  item.style.setProperty("--random-rotate-half", ((Math.random() - .5) * 35).toFixed(1) + "deg");
Â  Â  Â  gameContainer.appendChild(item);
Â  Â  Â  const hit = setInterval(() => {
Â  Â  Â  Â  if (!item.parentNode || timeLeft <= 0) { clearInterval(hit); if(item.parentNode)item.remove(); return; }
Â  Â  Â  Â  const a = item.getBoundingClientRect();
Â  Â  Â  Â  const b = character.getBoundingClientRect();
Â  Â  Â  Â  if (a.top < b.bottom && a.bottom > b.top && a.left < b.right && a.right > b.left) {
Â  Â  Â  Â  Â  handleItemCollection(item); 
Â  Â  Â  Â  Â  item.remove(); 
Â  Â  Â  Â  Â  clearInterval(hit);
Â  Â  Â  Â  }
Â  Â  Â  }, 30);
Â  Â  Â  setTimeout(() => {
Â  Â  Â  Â  if (item.parentNode) {
Â  Â  Â  Â  Â  item.remove();
Â  Â  Â  Â  Â  if (item.classList.contains("egg") && !isFeverModeActive) resetCombo();
Â  Â  Â  Â  }
Â  Â  Â  Â  clearInterval(hit);
Â  Â  Â  }, dur * 1000 + 300);
Â  Â  }

Â  Â  function startGame(){
Â  Â  Â  characterX=gameContainer.offsetWidth/2;character.style.left=characterX+"px";
Â  Â  Â  isCharacterStunned = false; 
Â  Â  Â  if (stunTimeoutId) clearTimeout(stunTimeoutId); 
Â  Â  Â  character.classList.remove("electrocuted"); 
Â  Â  Â  character.style.removeProperty('--current-scale'); 
Â  Â  Â  character.classList.remove("powerup");
Â  Â  Â  character.style.transform = ''; 

Â  Â  Â  isFeverModeActive = false;
Â  Â  Â  if (feverModeTimerId) clearInterval(feverModeTimerId);
Â  Â  Â  feverModeTimerId = null;
Â  Â  Â  feverSpawnedLevel2 = false;
      // â˜…ãƒ•ã‚£ãƒ¼ãƒãƒ¼æ¡ä»¶å¤‰æ›´: feverSpawnedByCombo60 ã‚’ãƒªã‚»ãƒƒãƒˆ
Â  Â  Â  feverSpawnedByCombo60 = false; 
Â  Â  Â  characterSpeedMultiplier = 1;
Â  Â  Â  gameContainer.classList.remove("fever-active");
Â  Â  Â  character.classList.remove("fever-character");
Â  Â  Â  if (feverBGM && typeof feverBGM.pause === 'function' && !feverBGM.paused) {
Â  Â  Â  Â  Â  feverBGM.pause();
Â  Â  Â  Â  Â  feverBGM.currentTime = 0;
Â  Â  Â  }
Â  Â  Â  originalBGMVolume = bgm.volume; 

Â  Â  Â  bgm.currentTime = 0; 
Â  Â  Â  bgm.play().catch(e => console.error("BGM play error:", e));
Â  Â  Â  createInGameTwinkleStars(isFeverModeActive ? 80 : 50); 
Â  Â  Â  itemSpawnerId=setInterval(createItem,spawnRate());
Â  Â  Â  gameBgParticleInterval=setInterval(createBgBubbleParticle,700);
Â  Â  Â  outerEffectInterval=setInterval(createOuterShellParticle,500);
Â  Â  Â  gameTimerId=setInterval(()=>{
Â  Â  Â  Â  if(timeLeft<=0){
Â  Â  Â  Â  Â  clearInterval(gameTimerId);clearInterval(itemSpawnerId);
Â  Â  Â  Â  Â  clearInterval(gameBgParticleInterval);clearInterval(outerEffectInterval);
Â  Â  Â  Â  Â  if(powerUpTimerId)clearInterval(powerUpTimerId);
Â  Â  Â  Â  Â  if (stunTimeoutId) clearTimeout(stunTimeoutId);
Â  Â  Â  Â  Â  if (feverModeTimerId) clearInterval(feverModeTimerId); 
Â  Â  Â  Â  Â  endGame();return;
Â  Â  Â  Â  }
Â  Â  Â  Â  timeLeft--;timerDisplay.textContent=timeLeft;
Â  Â  Â  Â  if (!isCharacterStunned) {
Â  Â  Â  Â  Â  Â  clearInterval(itemSpawnerId);itemSpawnerId=setInterval(createItem,spawnRate());
Â  Â  Â  Â  }
Â  Â  Â  },1000);
Â  Â  }
Â  Â  function endGame(){
Â  Â  Â  bgm.pause();
Â  Â  Â  if (isFeverModeActive) {
Â  Â  Â  Â  Â  deactivateFeverMode(false); 
Â  Â  Â  }
Â  Â  Â  if (feverBGM && typeof feverBGM.pause === 'function' && !feverBGM.paused) {
Â  Â  Â  Â  Â  feverBGM.pause();
Â  Â  Â  Â  Â  feverBGM.currentTime = 0;
Â  Â  Â  }
Â  Â  Â  finalScore.textContent=score;finalLevel.textContent=level;
Â  Â  Â  gameover.style.display="block";
Â  Â  Â  if(score>highscore){highscore=score;localStorage.setItem("rebornCatchHighscore",highscore);highscoreDisplay.textContent=highscore}
Â  Â  Â  
Â  Â  Â  const gameStars = gameContainer.querySelectorAll('.game-bg-star');
Â  Â  Â  gameStars.forEach(star => star.remove());
Â  Â  Â  [...gameContainer.children].forEach(c=>{
Â  Â  Â  Â  if(!["character","gameover","combo-display-popup","level-up-effect","power-effect", "fever-mode-display"].includes(c.id)){ 
Â  Â  Â  Â  Â  if(c.classList.contains("egg")||c.classList.contains("bomb")||c.classList.contains("power-up")||c.classList.contains("time-plus")||c.classList.contains("helper-mgchan")||c.classList.contains("helper-ikehaya")||c.classList.contains("helper-road")||c.classList.contains("lightning")||c.classList.contains("makimono")||c.classList.contains("bg-bubble-particle"))c.remove();
Â  Â  Â  Â  }
Â  Â  Â  });
Â  Â  Â  pageWrapper.querySelectorAll('.outer-shell-particle').forEach(e=>e.remove());
Â  Â  Â  returnToSelectBtn.onclick=()=>location.href="character_select.html"; 
Â  Â  }

Â  Â  document.addEventListener("keydown",e=>{
Â  Â  Â  if(timeLeft<=0 || isCharacterStunned)return;
Â  Â  Â  const w=character.offsetWidth||120;
Â  Â  Â  const moveAmount = 30 * characterSpeedMultiplier; 
Â  Â  Â  if(e.key==="ArrowLeft"){characterX-=moveAmount}
Â  Â  Â  else if(e.key==="ArrowRight"){characterX+=moveAmount}
Â  Â  Â  else if(e.key===" "||e.key==="ArrowUp"){e.preventDefault();jump()}
Â  Â  Â  characterX=Math.max(w/2,Math.min(gameContainer.offsetWidth-w/2,characterX));
Â  Â  Â  character.style.left=characterX+"px";
Â  Â  });

Â  Â  function jump(){ 
Â  Â  Â  if(character.classList.contains("jump")||timeLeft<=0 || isCharacterStunned)return;
Â  Â  Â  character.style.setProperty('--current-scale', getCurrentCharacterScale()); 
Â  Â  Â  character.classList.add("jump"); 
Â  Â  Â  setTimeout(()=>{
Â  Â  Â  Â  Â  character.classList.remove("jump");
Â  Â  Â  Â  Â  character.style.removeProperty('--current-scale');
Â  Â  Â  },600);
Â  Â  }
Â  Â  character.addEventListener("click",e=>{if(timeLeft>0 && !isCharacterStunned){e.preventDefault();jump()}},{passive:false});

Â  Â  const leftBtn=document.createElement("button"),rightBtn=document.createElement("button");
Â  Â  leftBtn.textContent="â—€";rightBtn.textContent="â–¶";
Â  Â  leftBtn.className=rightBtn.className="control-btn";
Â  Â  leftBtn.style.left="20px";rightBtn.style.right="20px";
Â  Â  pageWrapper.append(leftBtn,rightBtn);

Â  Â  let moveInt=null;
Â  Â  const startMove=dir=>{
Â  Â  Â  if(moveInt||timeLeft<=0 || isCharacterStunned)return;
Â  Â  Â  const w=character.offsetWidth||120;
Â  Â  Â  const baseMoveSpeed = 15;
Â  Â  Â  const moveAmount = baseMoveSpeed * characterSpeedMultiplier; 
Â  Â  Â  moveInt=setInterval(()=>{
Â  Â  Â  Â  characterX+=(dir==="left"?-moveAmount:moveAmount);
Â  Â  Â  Â  characterX=Math.max(w/2,Math.min(gameContainer.offsetWidth-w/2,characterX));
Â  Â  Â  Â  character.style.left=characterX+"px";
Â  Â  Â  },30);
Â  Â  };
Â  Â  const stopMove=()=>{clearInterval(moveInt);moveInt=null};
Â  Â  leftBtn.addEventListener("touchstart",e=>{e.preventDefault();if(!isCharacterStunned)startMove("left")},{passive:false});
Â  Â  rightBtn.addEventListener("touchstart",e=>{e.preventDefault();if(!isCharacterStunned)startMove("right")},{passive:false});
Â  Â  leftBtn.onmousedown=()=>{if(!isCharacterStunned)startMove("left")};
Â  Â  rightBtn.onmousedown=()=>{if(!isCharacterStunned)startMove("right")};
Â  Â  ["mouseup","touchend"].forEach(ev=>document.addEventListener(ev,stopMove,{passive:false}));

Â  Â  let sx=null,sy=null,thr=30;
Â  Â  const relX=cl=>cl-gameContainer.getBoundingClientRect().left;
Â  Â  gameContainer.addEventListener("touchstart",e=>{
Â  Â  Â  if(timeLeft<=0 || isCharacterStunned)return;
Â  Â  Â  const t=e.changedTouches[0];sx=relX(t.clientX);sy=t.clientY;
Â  Â  },{passive:true});
Â  Â  gameContainer.addEventListener("touchmove",e=>{
Â  Â  Â  const swipeMultiplier = isFeverModeActive ? 1.2 : 1; 
Â  Â  Â  if(timeLeft<=0||sx==null || isCharacterStunned)return;
Â  Â  Â  const x=relX(e.changedTouches[0].clientX),dx=(x-sx) * swipeMultiplier; characterX+=dx;sx=x;
Â  Â  Â  const w=character.offsetWidth||120;
Â  Â  Â  characterX=Math.max(w/2,Math.min(gameContainer.offsetWidth-w/2,characterX));
Â  Â  Â  character.style.left=characterX+"px";
Â  Â  },{passive:true});
Â  Â  gameContainer.addEventListener("touchend",e=>{
Â  Â  Â  if(timeLeft<=0||sx==null||sy==null || isCharacterStunned){sx=sy=null;return}
Â  Â  Â  const dx=relX(e.changedTouches[0].clientX)-sx,dy=e.changedTouches[0].clientY-sy;
Â  Â  Â  if(Math.abs(dy)>Math.abs(dx)&&dy<-thr)jump();
Â  Â  Â  sx=sy=null;
Â  Â  },{passive:true});

Â  Â  window.addEventListener('resize',()=>{ const w=character.offsetWidth||120; characterX=Math.max(w/2,Math.min(gameContainer.offsetWidth-w/2,characterX)); character.style.left=characterX+"px"; });
Â  Â  const tryPlay=()=>{ bgm.play().then(()=>{ document.body.removeEventListener('click',tryPlay); document.body.removeEventListener('touchstart',tryPlay); }).catch(()=>{}); };
Â  Â  document.body.addEventListener('click',tryPlay,{once:true});
Â  Â  document.body.addEventListener('touchstart',tryPlay,{once:true});

Â  Â  // =============== â˜…ãƒ•ã‚£ãƒ¼ãƒãƒ¼æ¡ä»¶å¤‰æ›´: checkAndSpawnFeverItem é–¢æ•°ã®ãƒ­ã‚¸ãƒƒã‚¯å¤‰æ›´ ===============
Â  Â  function checkAndSpawnFeverItem() {
Â  Â  Â  Â  if (isFeverModeActive || timeLeft <= 0) return; // ãƒ•ã‚£ãƒ¼ãƒãƒ¼ä¸­ã‚„ã‚²ãƒ¼ãƒ çµ‚äº†æ™‚ã¯ä½•ã‚‚ã—ãªã„

        // æ¡ä»¶1: ãƒ¬ãƒ™ãƒ«2åˆ°é”å¾Œã€ã‚³ãƒ³ãƒœ15å›ã§ãƒ•ã‚£ãƒ¼ãƒãƒ¼ã‚¢ã‚¤ãƒ†ãƒ  (1å›ã®ã¿)
Â  Â  Â  Â  if (level === 2 && combo >= 15 && !feverSpawnedLevel2) {
Â  Â  Â  Â  Â  Â  feverSpawnedLevel2 = true;
Â  Â  Â  Â  Â  Â  spawnMakimonoItem();
            return; // ã‚¢ã‚¤ãƒ†ãƒ ã‚’ã‚¹ãƒãƒ¼ãƒ³ã—ãŸã‚‰ä»–ã®æ¡ä»¶ã¯ãƒã‚§ãƒƒã‚¯ã—ãªã„
Â  Â  Â  Â  } 
        
        // æ¡ä»¶2: (ãƒ¬ãƒ™ãƒ«ä¸å•) ã‚³ãƒ³ãƒœ60å›ã§ãƒ•ã‚£ãƒ¼ãƒãƒ¼ã‚¢ã‚¤ãƒ†ãƒ  (1å›ã®ã¿)
        // level === 5 ã®ç¸›ã‚Šã‚’ãªãã—ã€æ–°ã—ã„ãƒ•ãƒ©ã‚° feverSpawnedByCombo60 ã§ç®¡ç†
        if (combo >= 60 && !feverSpawnedByCombo60) {
            feverSpawnedByCombo60 = true;
            spawnMakimonoItem();
            return; // ã‚¢ã‚¤ãƒ†ãƒ ã‚’ã‚¹ãƒãƒ¼ãƒ³ã—ãŸã‚‰ä»–ã®æ¡ä»¶ã¯ãƒã‚§ãƒƒã‚¯ã—ãªã„
        }
Â  Â  }

Â  Â  function activateFeverMode() {
Â  Â  Â  Â  if (isFeverModeActive) return; 
Â  Â  Â  Â  isFeverModeActive = true;
Â  Â  Â  Â  feverModeEndTime = Date.now() + FEVER_DURATION;
Â  Â  Â  Â  seFeverStart?.play().catch(e => console.error("Audio play error:", e));
Â  Â  Â  Â  bgm.pause();
Â  Â  Â  Â  feverBGM.currentTime = 0;
Â  Â  Â  Â  feverBGM.play().catch(e => console.error("Fever BGM play error:", e));
Â  Â  Â  Â  gameContainer.classList.add("fever-active");
Â  Â  Â  Â  character.classList.add("fever-character");
Â  Â  Â  Â  character.style.transform = `translateX(-50%) scale(${getCurrentCharacterScale()})`; 
Â  Â  Â  Â  feverModeDisplay.style.display = 'block';
Â  Â  Â  Â  setTimeout(() => {
Â  Â  Â  Â  Â  Â  if (feverModeDisplay) feverModeDisplay.style.display = 'none';
Â  Â  Â  Â  }, 2500); 
Â  Â  Â  Â  createInGameTwinkleStars(isFeverModeActive ? 80 : 50); 
Â  Â  Â  Â  characterSpeedMultiplier = 1.6; 
Â  Â  Â  Â  const existingBombs = gameContainer.querySelectorAll(".bomb");
Â  Â  Â  Â  existingBombs.forEach(bombNode => {
Â  Â  Â  Â  Â  Â  bombNode.className = "egg golden fever-item-glow"; 
Â  Â  Â  Â  Â  Â  bombNode.dataset.points = "10"; 
Â  Â  Â  Â  Â  Â  bombNode.dataset.type = "feverBombPoints";
Â  Â  Â  Â  Â  Â  if (bombNode.firstChild && bombNode.firstChild.nodeType === Node.ELEMENT_NODE && bombNode.firstChild.tagName === '::before') {
Â  Â  Â  Â  Â  Â  } else {
Â  Â  Â  Â  Â  Â  Â  Â  Â bombNode.innerHTML = ''; 
Â  Â  Â  Â  Â  Â  }
Â  Â  Â  Â  Â  Â  const dur = Math.max(1.5, 2.5 + Math.random() * 2 - level * 0.15);
Â  Â  Â  Â  Â  Â  bombNode.style.animationDuration = dur + "s";
Â  Â  Â  Â  Â  Â  bombNode.style.animationName = "fall-golden-egg"; 
Â  Â  Â  Â  });
Â  Â  Â  Â  feverModeTimerId = setInterval(() => {
Â  Â  Â  Â  Â  Â  const timeLeftFever = Math.ceil((feverModeEndTime - Date.now()) / 1000);
Â  Â  Â  Â  Â  Â  if (timeLeftFever <= 0 || timeLeft <= 0) {
Â  Â  Â  Â  Â  Â  Â  Â  deactivateFeverMode();
Â  Â  Â  Â  Â  Â  }
Â  Â  Â  Â  }, 100);
Â  Â  Â  Â  clearInterval(itemSpawnerId);
Â  Â  Â  Â  itemSpawnerId = setInterval(createItem, spawnRate());
Â  Â  }

Â  Â  function deactivateFeverMode(switchToMainBGM = true) {
Â  Â  Â  Â  if (!isFeverModeActive) return;
Â  Â  Â  Â  isFeverModeActive = false;
Â  Â  Â  Â  if(feverModeTimerId) clearInterval(feverModeTimerId);
Â  Â  Â  Â  feverModeTimerId = null;
Â  Â  Â  Â  if (switchToMainBGM) {
Â  Â  Â  Â  Â  Â  feverBGM.pause();
Â  Â  Â  Â  Â  Â  bgm.volume = originalBGMVolume;
Â  Â  Â  Â  Â  Â  bgm.currentTime = 0; 
Â  Â  Â  Â  Â  Â  bgm.play().catch(e => console.error("Main BGM resume error:", e));
Â  Â  Â  Â  }
Â  Â  Â  Â  gameContainer.classList.remove("fever-active");
Â  Â  Â  Â  character.classList.remove("fever-character");
Â  Â  Â  Â  character.style.transform = `translateX(-50%) scale(${getCurrentCharacterScale()})`; 
Â  Â  Â  Â  createInGameTwinkleStars(50);
Â  Â  Â  Â  characterSpeedMultiplier = 1;
Â  Â  Â  Â  clearInterval(itemSpawnerId);
Â  Â  Â  Â  itemSpawnerId = setInterval(createItem, spawnRate());
Â  Â  }
Â  Â  startGame();
Â  </script>
</body>
</html>
